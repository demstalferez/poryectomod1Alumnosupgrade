import streamlit as st

def show_tasks():
    # Agrega estilos globales
    st.markdown(
        """
        <style>
        /* Cualquier elemento con la clase 'white-bg' o 'highlight' (si es fondo blanco) mostrar√° texto negro */
        .white-bg, .highlight {
            background-color: white !important;
            color: black !important;
        }
        /* Aseguramos que el texto de la app sea negro por defecto */
        body {
            color: black !important;
        }
        </style>
        """,
        unsafe_allow_html=True
    )

    st.markdown('<h1 class="section-title">üìù Tareas del Desaf√≠o</h1>', unsafe_allow_html=True)
    
    st.markdown("""
    <div class="highlight">
        <p>Este desaf√≠o est√° estructurado en tres fases principales: <strong>Limpieza</strong>, <strong>An√°lisis</strong> y <strong>Presentaci√≥n</strong>. Cada fase tiene tareas espec√≠ficas que te permitir√°n desarrollar un proyecto completo de an√°lisis de datos.</p>
        <p>Sigue la metodolog√≠a propuesta para asegurar un enfoque sistem√°tico y profesional.</p>
    </div>
    """, unsafe_allow_html=True)
    
    # Cronograma sugerido
    st.markdown('<h2 class="subsection-title">Cronograma Sugerido</h2>', unsafe_allow_html=True)
   
    
    # Fase 1: Limpieza
    st.markdown('<h2 class="subsection-title">Fase 1: Limpieza y Preparaci√≥n de Datos</h2>', unsafe_allow_html=True)
    
    tasks_cleaning = [
        {
            "title": "1. Exploraci√≥n Inicial del Dataset",
            "desc": "Realiza una exploraci√≥n completa del archivo marketingcampaigns.csv para comprender sus caracter√≠sticas y problemas.",
            "steps": [
                "Examina las primeras y √∫ltimas filas para entender la estructura general del dataset",
                "Verifica los tipos de datos de cada columna y su coherencia con los valores esperados",
                "Identifica valores faltantes y su distribuci√≥n por columna",
                "Calcula estad√≠sticas descriptivas b√°sicas para detectar anomal√≠as y posibles outliers",
                "Analiza la distribuci√≥n de variables categ√≥ricas para detectar errores ortogr√°ficos o inconsistencias",
                "Documenta todos los problemas encontrados y prioriza su resoluci√≥n"
            ]
        },
        {
            "title": "2. Manejo de Valores Faltantes",
            "desc": "Desarrolla una estrategia coherente para manejar valores faltantes en diferentes columnas.",
            "steps": [
                "Cuantifica el porcentaje de valores faltantes por columna para evaluar su impacto",
                "Para 'budget': considera usar la mediana por tipo de campa√±a o canal",
                "Para 'type': determina si asignar 'unknown' o utilizar t√©cnicas de imputaci√≥n basadas en otras variables",
                "Para 'conversion_rate': eval√∫a la correlaci√≥n con otras variables antes de decidir la estrategia de imputaci√≥n",
                "Para 'roi' y 'revenue': analiza la relaci√≥n entre estas variables y 'budget' para una imputaci√≥n coherente",
                "Documenta y justifica cada decisi√≥n de imputaci√≥n o eliminaci√≥n"
            ]
        },
        {
            "title": "3. Correcci√≥n de Formatos Inconsistentes",
            "desc": "Estandariza los formatos de fechas, n√∫meros y valores monetarios para permitir un an√°lisis coherente.",
            "steps": [
                "Normaliza los decimales en 'roi' y 'conversion_rate' para usar un formato consistente (punto o coma)",
                "Convierte las fechas a un formato est√°ndar (YYYY-MM-DD) y maneja fechas inv√°lidas",
                "Asegura que 'budget' y 'revenue' sean valores num√©ricos sin s√≠mbolos de moneda o separadores de miles",
                "Verifica la consistencia de unidades (ej: aseg√∫rate que 'conversion_rate' siempre est√© en porcentaje o decimal)",
                "Implementa validaciones para confirmar que la conversi√≥n de formatos ha sido exitosa"
            ]
        },
        {
            "title": "4. Eliminaci√≥n de Duplicados",
            "desc": "Identifica y maneja filas duplicadas que pueden distorsionar los resultados del an√°lisis.",
            "steps": [
                "Busca duplicados exactos (todas las columnas id√©nticas)",
                "Identifica duplicados parciales (misma campa√±a con ligeras variaciones en los datos)",
                "Desarrolla criterios para decidir qu√© fila conservar cuando hay duplicados parciales",
                "Documenta cu√°ntas filas se eliminaron y el impacto en el dataset",
                "Verifica que la eliminaci√≥n de duplicados no ha creado sesgos en los datos"
            ]
        },
        {
            "title": "5. Manejo de Valores At√≠picos (Outliers)",
            "desc": "Identifica y trata valores extremos que pueden representar errores o campa√±as excepcionales.",
            "steps": [
                "Utiliza m√©todos estad√≠sticos (IQR, Z-score) para detectar outliers en variables num√©ricas",
                "Analiza 'budget' y 'revenue' para identificar valores inusualmente altos o bajos",
                "Eval√∫a cada outlier en su contexto para determinar si es un error o un dato v√°lido",
                "Decide si transformar, eliminar o mantener cada outlier bas√°ndote en evidencia",
                "Documenta el impacto de tu estrategia de manejo de outliers en el an√°lisis posterior"
            ]
        },
        {
            "title": "6. Correcci√≥n de Errores de Texto",
            "desc": "Estandariza y corrige errores ortogr√°ficos en las variables categ√≥ricas.",
            "steps": [
                "Identifica variaciones ortogr√°ficas en 'channel' (como 'referal' vs 'referral')",
                "Normaliza valores en 'target_audience' para usar consistentemente 'B2B' o 'B2C'",
                "Corrige errores en 'type' para unificar categor√≠as",
                "Utiliza t√©cnicas como normalizaci√≥n de texto y distancia de edici√≥n para automatizar correcciones",
                "Verifica la consistencia despu√©s de las correcciones"
            ]
        },
        {
            "title": "7. Creaci√≥n de Variables Derivadas",
            "desc": "Enriquece el dataset con nuevas variables que proporcionen insights adicionales.",
            "steps": [
                "Calcula 'net_profit' (beneficio neto) restando 'budget' de 'revenue'",
                "Extrae componentes temporales de la fecha (mes, trimestre, a√±o) para an√°lisis estacional",
                "Crea categor√≠as de rendimiento basadas en ROI y tasa de conversi√≥n",
                "Calcula m√©tricas de eficiencia como 'cost_per_conversion'",
                "Considera variables binarias (flags) para caracter√≠sticas importantes"
            ]
        },
        {
            "title": "8. Validaci√≥n Final de Datos",
            "desc": "Verifica la calidad e integridad del dataset limpio antes del an√°lisis.",
            "steps": [
                "Comprueba que todas las columnas tienen los tipos de datos correctos",
                "Verifica la consistencia entre variables relacionadas (ej: budget, revenue, roi)",
                "Realiza validaciones cruzadas para detectar inconsistencias l√≥gicas",
                "Asegura que no quedan valores nulos sin justificaci√≥n",
                "Documenta el proceso completo de limpieza y las transformaciones realizadas"
            ]
        }
    ]
    
    for task in tasks_cleaning:
        with st.expander(f"{task['title']}"):
            st.markdown(f"**Descripci√≥n:** {task['desc']}")
            st.markdown("**Pasos:**")
            for step in task["steps"]:
                st.markdown(f"- {step}")
    
    # Fase 2: An√°lisis
    st.markdown('<h2 class="subsection-title">Fase 2: An√°lisis Exploratorio</h2>', unsafe_allow_html=True)
    
    st.markdown("""
    Una vez que hayas limpiado y preparado los datos, deber√°s responder a las siguientes preguntas anal√≠ticas utilizando t√©cnicas de an√°lisis exploratorio y visualizaci√≥n de datos:
    """)
    
    questions = [
        {
            "question": "¬øQu√© canal de marketing se utiliza con mayor frecuencia y cu√°l genera mejor ROI?",
            "description": "Analiza la distribuci√≥n de canales y compara su rendimiento en t√©rminos de ROI y otros indicadores clave.",
            "approach": "Combina an√°lisis de frecuencia con m√©tricas de rendimiento para identificar no solo los canales m√°s utilizados sino tambi√©n los m√°s efectivos. Considera segmentar por tipo de campa√±a o audiencia para un an√°lisis m√°s detallado.",
            "visualization": "Gr√°fico de barras para frecuencia y diagrama de caja para distribuci√≥n de ROI por canal"
        },
        {
            "question": "¬øQu√© tipo de campa√±a genera m√°s ingresos en promedio y cu√°l tiene mejor conversi√≥n?",
            "description": "Compara los diferentes tipos de campa√±a para identificar cu√°les generan m√°s ingresos y tienen mejor tasa de conversi√≥n.",
            "approach": "Analiza el rendimiento financiero (ingresos, beneficio neto) y las m√©tricas de efectividad (tasa de conversi√≥n, ROI) por tipo de campa√±a. Busca si existen relaciones entre estas m√©tricas que puedan explicar el √©xito de ciertos tipos.",
            "visualization": "Gr√°fico de barras para ingresos promedio y tasa de conversi√≥n por tipo, diagrama de dispersi√≥n para correlaci√≥n entre estas m√©tricas"
        },
        {
            "question": "¬øC√≥mo se distribuye el ROI entre las campa√±as? ¬øQu√© factores est√°n asociados con un ROI alto?",
            "description": "Analiza la distribuci√≥n del ROI y busca patrones o factores que est√©n asociados con mejores resultados.",
            "approach": "Estudia la distribuci√≥n estad√≠stica del ROI, identifica segmentos de alto rendimiento y analiza qu√© caracter√≠sticas comparten. Busca correlaciones con otras variables como presupuesto, canal, tipo o audiencia.",
            "visualization": "Histograma y boxplot del ROI, heatmap de correlaciones, gr√°ficos de dispersi√≥n con ROI como variable objetivo"
        },
        {
            "question": "¬øHay diferencias significativas en la tasa de conversi√≥n entre audiencias B2B y B2C?",
            "description": "Compara las tasas de conversi√≥n entre los dos tipos de audiencia para determinar si existen diferencias en el comportamiento de compra.",
            "approach": "Realiza an√°lisis comparativos entre ambos segmentos, no solo para tasa de conversi√≥n sino tambi√©n para otras m√©tricas. Considera el an√°lisis por subgrupos combinando audiencia con canal o tipo de campa√±a.",
            "visualization": "Gr√°fico de cajas comparativo, gr√°ficos de barras agrupados por audiencia y canal/tipo"
        },
        {
            "question": "¬øQu√© campa√±a tiene el mayor beneficio neto (net_profit)? ¬øQu√© caracter√≠sticas la hacen exitosa?",
            "description": "Identifica las campa√±as m√°s rentables y analiza qu√© factores contribuyen a su √©xito.",
            "approach": "Realiza un ranking de campa√±as seg√∫n beneficio neto y analiza en profundidad las caracter√≠sticas de las m√°s exitosas. Busca patrones comunes que puedan replicarse en futuras campa√±as.",
            "visualization": "Tabla con las top 5-10 campa√±as por beneficio neto, gr√°ficos comparativos con estas campa√±as destacadas"
        },
        {
            "question": "¬øExiste correlaci√≥n entre el presupuesto (budget) y los ingresos (revenue)?",
            "description": "Analiza si un mayor presupuesto se traduce en mayores ingresos y si hay un punto √≥ptimo de inversi√≥n.",
            "approach": "Estudia la relaci√≥n entre presupuesto e ingresos mediante an√°lisis de correlaci√≥n y regresi√≥n. Busca si la relaci√≥n es lineal o si hay rendimientos decrecientes a partir de cierto punto.",
            "visualization": "Gr√°fico de dispersi√≥n con l√≠nea de tendencia, posiblemente segmentado por canal o tipo de campa√±a"
        },
        {
            "question": "¬øQu√© campa√±as tienen un ROI mayor a 0.5 y ingresos encima de 500,000?",
            "description": "Identifica las campa√±as de alto rendimiento que cumplan ambos criterios para posible replicaci√≥n.",
            "approach": "Filtra las campa√±as seg√∫n los criterios establecidos y analiza sus caracter√≠sticas comunes. Considera crear un sistema de clasificaci√≥n m√°s completo con m√∫ltiples criterios.",
            "visualization": "Tabla filtrada o gr√°fico de cuadrantes que muestre las campa√±as de alto rendimiento"
        },
        {
            "question": "¬øExisten patrones estacionales o temporales en el rendimiento de las campa√±as?",
            "description": "Analiza si hay variaciones en el rendimiento seg√∫n la √©poca del a√±o o tendencias a lo largo del tiempo.",
            "approach": "Utiliza los componentes temporales extra√≠dos de la fecha para agrupar y comparar el rendimiento a lo largo del tiempo. Busca patrones estacionales o tendencias generales.",
            "visualization": "Gr√°ficos de l√≠nea temporal, heatmaps por mes y tipo de campa√±a, an√°lisis de rendimiento por trimestre"
        }
    ]
    
    for i, q in enumerate(questions, 1):
        with st.expander(f"{i}. {q['question']}"):
            st.markdown(f"**Objetivo:** {q['description']}")
            st.markdown(f"**Enfoque sugerido:** {q['approach']}")
            st.markdown(f"**Visualizaciones recomendadas:** {q['visualization']}")
    
    # Fase 3: Presentaci√≥n
    st.markdown('<h2 class="subsection-title">Fase 3: Documentaci√≥n y Presentaci√≥n</h2>', unsafe_allow_html=True)
    
    st.markdown("""
    <div class="highlight">
        <p>La fase final del proyecto consiste en documentar tu trabajo y preparar una presentaci√≥n efectiva que comunique tus hallazgos y recomendaciones.</p>
    </div>
    """, unsafe_allow_html=True)
    
    documentation_tasks = [
        {
            "title": "1. Documentaci√≥n en GitHub",
            "desc": "Prepara un repositorio GitHub completo y bien organizado.",
            "steps": [
                "Crea un README.md detallado con t√≠tulo, descripci√≥n del proyecto y tu nombre",
                "Organiza el c√≥digo en notebooks o scripts con secciones claras y comentarios explicativos",
                "Incluye el dataset limpio final (marketingcampaigns_clean.csv)",
                "Documenta todas las decisiones de limpieza y transformaci√≥n",
                "A√±ade visualizaciones clave y sus interpretaciones",
                "Considera incluir un documento de insights con recomendaciones"
            ]
        },
        {
            "title": "2. Preparaci√≥n de la Presentaci√≥n",
            "desc": "Desarrolla una presentaci√≥n efectiva de 10 minutos que comunique lo esencial.",
            "steps": [
                "Estructura tu presentaci√≥n con introducci√≥n, m√©todos, hallazgos y recomendaciones",
                "Selecciona las 3-5 visualizaciones m√°s impactantes que mejor cuenten la historia de los datos",
                "Destaca insights accionables que la empresa pueda implementar",
                "Cuantifica el impacto potencial de tus recomendaciones cuando sea posible",
                "Ensaya tu presentaci√≥n para asegurarte de que se ajusta al tiempo permitido",
                "Prep√°rate para posibles preguntas sobre tu metodolog√≠a y conclusiones"
            ]
        }
    ]
    
    for task in documentation_tasks:
        with st.expander(f"{task['title']}"):
            st.markdown(f"**Descripci√≥n:** {task['desc']}")
            st.markdown("**Pasos:**")
            for step in task["steps"]:
                st.markdown(f"- {step}")
    
    # Consejos para un proyecto exitoso
    st.markdown('<h2 class="subsection-title">Consejos para un Proyecto Exitoso</h2>', unsafe_allow_html=True)
    
    st.markdown("""
    - **Enfoque iterativo**: Avanza paso a paso y revisa constantemente tu progreso
    - **Documentaci√≥n continua**: Documenta decisiones y hallazgos mientras trabajas, no al final
    - **Prioriza la calidad sobre la cantidad**: Enf√≥cate en an√°lisis profundos de alta calidad
    - **Contextualiza tus hallazgos**: Relaciona los insights con el negocio y su impacto potencial
    - **Visualizaciones efectivas**: Dise√±a gr√°ficos claros con t√≠tulos informativos y etiquetas adecuadas
    - **Storytelling con datos**: Construye una narrativa coherente que gu√≠e a trav√©s de tus descubrimientos
    - **Pensamiento cr√≠tico**: Cuestiona tus propios resultados y busca explicaciones alternativas
    - **Control de versiones**: Usa Git de manera efectiva para gestionar los cambios en tu c√≥digo
    - **Revisi√≥n por pares**: Si es posible, pide a compa√±eros que revisen tu trabajo
    - **Practica tu presentaci√≥n**: Ensaya varias veces para lograr una exposici√≥n clara y ajustada al tiempo
    """)
    
    # Recursos adicionales
    with st.expander("Recursos Adicionales"):
        st.markdown("""
        **Limpieza de datos:**
        - [Gu√≠a de Pandas para limpieza de datos](https://pandas.pydata.org/pandas-docs/stable/user_guide/missing_data.html)
        - [Art√≠culo: "Tidy Data" por Hadley Wickham](https://www.jstatsoft.org/article/view/v059i10)
        
        **Visualizaci√≥n:**
        - [Gu√≠a de Matplotlib](https://matplotlib.org/stable/tutorials/index.html)
        - [Documentaci√≥n de Seaborn](https://seaborn.pydata.org/tutorial.html)
        - [Plotly para visualizaciones interactivas](https://plotly.com/python/)
        
        **An√°lisis de datos:**
        - [Data Analysis with Python Cheat Sheet](https://pandas.pydata.org/Pandas_Cheat_Sheet.pdf)
        - [T√©cnicas de an√°lisis exploratorio de datos](https://towardsdatascience.com/exploratory-data-analysis-8fc1cb20fd15)
        
        **Presentaci√≥n de datos:**
        - [Storytelling with Data (blog)](http://www.storytellingwithdata.com/)
        - [Mejores pr√°cticas para presentaciones de datos](https://hbr.org/2016/06/visualizations-that-really-work)
        """)